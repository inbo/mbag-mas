---
title: "Exploratie uitbreiding MAS 2023"
author: "Ward Langeraert"
date: "`r Sys.Date()`"
output:
  bookdown::html_document2:
    code_folding: hide
    toc: true
    toc_float: true
    toc_collapsed: true
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# set up
library(knitr)
library(here)
opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  out.width = "100%"
)
opts_knit$set(root.dir = here::here())

Sys.setenv("PROJ_NETWORK" = "ON")
```

```{r}
# packages
library(tidyverse)
library(INBOtheme)
library(sf)

theme_set(theme_inbo(transparent = TRUE))

# Conflicts
conflicted::conflicts_prefer(dplyr::filter)
conflicted::conflicts_prefer(dplyr::select)
conflicted::conflicts_prefer(dplyr::lag)

# Paths
data_path <- here("data", "mas")
media_path <- here("media", "exploratie_2023")
dir.create(media_path, showWarnings = FALSE)
```

# Doel

Exploratie gegevens Zandleemstreek en Westelijke leemstreek 2023 voor eerste rapport MBAG.


# Inlezen data

```{r}
file_geojson_2023 <- file.path(data_path, 
                               "20230810_qgis_export_sovon_wfs_2023.geojson")
mas_geojson_2023 <- read_sf(file_geojson_2023)
```

We moeten een reeks selecties en data preparatiestappen doen.
In een later stadium worden deze best in een analysepijplijn (bv. targets) gegoten.

## CRS

De CRS moet aangepast worden naar van Amersfoort naar Lambert 72. Dit doen we via een specifieke pipeline, zie: https://inbo.github.io/tutorials/tutorials/spatial_transform_crs_2/

```{r}
pipelines <- sf_proj_pipelines("EPSG:28992", "EPSG:31370")
glimpse(pipelines)
```

```{r}
# We select the pipeline with lowest accuracy (< 0.02), by filtering on accuracy.
# If the grids are installed, this should match the first line of the pipelines object.
chosen_pipeline_definition <- pipelines %>%
  filter(accuracy < 0.02) %>% 
  pull(definition)

mas_31370_pipeline <- 
  st_transform(st_geometry(mas_geojson_2023), "EPSG:31370",
               pipeline = chosen_pipeline_definition) %>% 
  st_sf(st_drop_geometry(mas_geojson_2023), geometry = .) %>% 
  as_tibble() %>% 
  st_as_sf() %>%
  rename(x_amersfoord = x_coord,
         y_amersfoord = y_coord) %>%
  mutate(x_lambert = unlist(map(.data$geometry, 1)),
         y_lambert = unlist(map(.data$geometry, 2))) %>%
  select(oid:y_amersfoord, x_lambert, y_lambert, everything())
```

## Data selectie
### Landbouwstreken

We selecteren de data van de Zandleemstreek en de Westelijke leemstreek.
Dit doen we door te joinen met de steekproef.

```{r}
steekproef_avimap <- read_csv(here("data", "steekproefkaders",
                                   "steekproef_avimap_mbag_piloot.csv"))

steekproef_avimap_subset <- steekproef_avimap %>%
  filter(regio %in% c("Westelijke leemstreek", "Zandleemstreek"))

mas_data_regios <- mas_31370_pipeline %>%
  inner_join(steekproef_avimap_subset, by = join_by(plotnaam == pointid))
```

### Telrondes

We selecteren dan de MAS-data binnen de telrondes.

```{r}
r1_start <- "04-01"
r1_stop  <- "04-20"
r2_start <- "04-21"
r2_stop  <- "05-10"
r3_start <- "05-11"
r3_stop  <- "06-10"
r4_start <- "06-21"
r4_stop  <- "07-15"

mas_telperiodes <- mas_data_regios %>%
  mutate(
    datum = ymd(paste(jaar, maand, dag, sep = "-")),
    periode_in_jaar = case_when(
      datum %within% interval(
        ymd(paste(jaar, r1_start, sep = "-")),
        ymd(paste(jaar, r1_stop, sep = "-"))) ~ "R1",
      datum %within% interval(
        ymd(paste(jaar, r2_start, sep = "-")),
        ymd(paste(jaar, r2_stop, sep = "-"))) ~ "R2",
      datum %within% interval(
        ymd(paste(jaar, r3_start, sep = "-")),
        ymd(paste(jaar, r3_stop, sep = "-"))) ~ "R3",
      datum %within% interval(
        ymd(paste(jaar, r4_start, sep = "-")),
        ymd(paste(jaar, r4_stop, sep = "-"))) ~ "R4"
    )) %>%
  filter(!is.na(periode_in_jaar))
```

### Telcirkel

We herberekenen de afstanden tussen de waarnemingen en de telpunten. We ronden af to 1 m nauwkeurig.

```{r}
steekproef_avimap_subset_sf <- steekproef_avimap_subset %>%
  st_as_sf(coords = c("x_coord", "y_coord"), crs = 31370) %>%
  select(plotnaam = pointid, regio, geometry)

mas_controle_afstand <- mas_telperiodes %>%
  select(oid, plotnaam, distance2plot, naam, jaar, waarnemer = waarneme) %>%
  inner_join(steekproef_avimap_subset_sf %>% as_tibble(),
             by = c("plotnaam"), suffix = c(".stip", ".telpunt")) %>%
  mutate(calc_distance = st_distance(.$geometry.stip, .$geometry.telpunt,
            by_element = TRUE),
         calc_distance = round(units::drop_units(calc_distance))) %>%
  st_drop_geometry()
```

We selecteren vervolgens alle waarnemingen binnen een afstand van 300 m.

```{r}
mas_distance <- mas_telperiodes %>%
  full_join(mas_controle_afstand, 
            by = join_by(oid, plotnaam, naam, jaar, distance2plot, regio)) %>%
  select(-c(distance2plot, geometry.telpunt, waarneme)) %>%
  rename(distance2plot = calc_distance) %>%
  filter(distance2plot <= 300)
```

De afstanden van de waarnemingen tot het middelpunt zijn correct:

```{r}
detail <- c("xmin" = 193500,
            "ymin" = 179000,
            "xmax" = 201000,
            "ymax" = 185000)

detail_sf <- tibble(geometry = st_as_sfc(st_bbox(detail))) %>% 
  st_as_sf() %>%
  st_set_crs(31370)

mapview::mapview(st_crop(steekproef_avimap_subset_sf, detail_sf),
                 legend = FALSE) +
  mapview::mapview(st_crop(st_buffer(mas_distance, mas_distance$distance2plot),
                           detail_sf), 
                   alpha.regions = 0,
                   legend = FALSE) +
  mapview::mapview(detail_sf, alpha.regions = 0)
```

### Zoogdieren en vogels

```{r}
mas_soortgrp <- mas_distance %>%
  filter(soortgrp %in% 1:2)
```

## Dubbeltellingen

Er zijn geen punten dubbelgeteld.

```{r}
mas_soortgrp %>%
  st_drop_geometry() %>%
  group_by(plotnaam, jaar, periode_in_jaar) %>%
  summarize(aantal_teldagen = n_distinct(doy),
            aantal_waarnemers = n_distinct(waarnemer),
            .groups = "drop") %>%
  filter(aantal_teldagen > 1 | aantal_waarnemers > 1) %>%
  kable()
```

## Soortnamen

We controleren de soortnamen. Voor de vogels hebben we:

```{r}
vogels <- mas_soortgrp %>%
  filter(soortgrp == 2) %>%
  distinct(naam) %>%
  arrange(naam) %>%
  pull(naam)
vogels
```

We vervangen `Engelse Kwikstaart` door `Gele Kwikstaart` en `Rouwkwikstaart` door `Witte Kwikstaart`.
We vervangen enkel de soortnaam. Het soortnummer blijft behouden.

Voor de zoogdieren hebben we:

```{r}
zoogdieren <- mas_soortgrp %>%
  filter(soortgrp == 1) %>%
  distinct(naam) %>%
  arrange(naam) %>%
  pull(naam)
zoogdieren
```

```{r}
# Code allows to adjust for other subspecies as well!
mas_2023_clean <- mas_soortgrp %>%
  mutate(
    naam = case_when(
      tolower(naam) %in% tolower(c("gele kwikstaart (spec)", 
                                   "engelse kwikstaart"))
        ~ "Gele Kwikstaart",
      tolower(naam) %in% tolower(c("witte kwikstaart (spec)", 
                                   "Rouwkwikstaart"))
        ~ "Witte Kwikstaart",
      tolower(naam) == tolower("canadese gans spec.") 
        ~ "Grote Canadese Gans",
      tolower(naam) == tolower("Witsterblauwborst") 
        ~ "Blauwborst",
      TRUE ~ naam
      )
    )
```

```{r}
glimpse(mas_2023_clean)
```

# Vogels 2023

```{r}
mas_2023_vogels <- mas_2023_clean %>%
  filter(soortgrp == 2)  # vogels
```

## Enkele cijfers

```{r}
summary_vogels_2023 <- mas_2023_vogels %>%
  st_drop_geometry() %>%
  group_by(regio, jaar) %>%
  mutate(aantal_soorten_regiojaar = n_distinct(naam)) %>%
  group_by(regio, jaar, openheid_klasse, sbp) %>%
  mutate(aantal_waarnemingen = n_distinct(oid), 
         aantal_plots = n_distinct(plotid), 
         aantal_soorten_stratum = n_distinct(naam)) %>%
  ungroup() %>%
  distinct(regio, jaar, openheid_klasse, sbp, aantal_waarnemingen, aantal_plots,
           aantal_soorten_stratum, aantal_soorten_regiojaar) %>%
  arrange(regio, jaar, openheid_klasse, sbp)

summary_vogels_2023 %>%
  kable()
```

```{r}
mas_2023_vogels %>%
  st_drop_geometry() %>%
  group_by(regio, jaar, periode_in_jaar) %>%
  summarise(aantal_waarnemingen = n_distinct(oid),
            .groups = "drop") %>%
  ggplot() +
    geom_bar(aes(x = periode_in_jaar, y = aantal_waarnemingen),
             stat = "identity") +
    facet_wrap(~regio) +
    labs(x = "Telperiode", y = "Aantal waarnemingen")
```

## Soortendiversiteit

Het aantal soorten neemt vooral toe in de eerste twee telperiodes.

```{r}
cum_aantal_spec <- mas_2023_vogels %>% 
  st_drop_geometry() %>%
  group_by(regio, naam) %>% 
  filter(datum == min(datum)) %>% 
  slice(1) %>% # takes the first occurrence if there is a tie
  ungroup() %>%
  group_by(regio, datum) %>%
  summarise(n_spec = n_distinct(naam),
            .groups = "drop") %>%
  group_by(regio) %>%
  arrange(datum) %>%
  mutate(cum_sum = cumsum(n_spec)) %>%
  ungroup()

jaar <- 2023
cum_aantal_spec %>%
  ggplot(aes(x = datum, y = cum_sum, colour = regio)) +
    annotate("rect",
           xmin = ymd(paste(jaar, r1_start, sep = "-")),
           xmax = ymd(paste(jaar, r1_stop, sep = "-")),
           ymin = 0, ymax = Inf,
           alpha = 0.2) +
    annotate("text", label = "R1",
           x = ymd(paste(jaar, r1_start, sep = "-")) + 
             (ymd(paste(jaar, r1_stop, sep = "-")) -
                ymd(paste(jaar, r1_start, sep = "-"))) / 2,
           y = 0,
           vjust = -1) +
    annotate("rect",
           xmin = ymd(paste(jaar, r2_start, sep = "-")),
           xmax = ymd(paste(jaar, r2_stop, sep = "-")),
           ymin = 0, ymax = Inf,
           alpha = 0.2) +
    annotate("text", label = "R2",
           x = ymd(paste(jaar, r2_start, sep = "-")) + 
             (ymd(paste(jaar, r2_stop, sep = "-")) -
                ymd(paste(jaar, r2_start, sep = "-"))) / 2,
           y = 0,
           vjust = -1) +
    annotate("rect",
           xmin = ymd(paste(jaar, r3_start, sep = "-")),
           xmax = ymd(paste(jaar, r3_stop, sep = "-")),
           ymin = 0, ymax = Inf,
           alpha = 0.2) +
    annotate("text", label = "R3",
           x = ymd(paste(jaar, r3_start, sep = "-")) + 
             (ymd(paste(jaar, r3_stop, sep = "-")) -
                ymd(paste(jaar, r3_start, sep = "-"))) / 2,
           y = 0,
           vjust = -1) +
    annotate("rect",
           xmin = ymd(paste(jaar, r4_start, sep = "-")),
           xmax = ymd(paste(jaar, r4_stop, sep = "-")),
           ymin = 0, ymax = Inf,
           alpha = 0.2) +
    annotate("text", label = "R4",
           x = ymd(paste(jaar, r4_start, sep = "-")) + 
             (ymd(paste(jaar, r4_stop, sep = "-")) -
                ymd(paste(jaar, r4_start, sep = "-"))) / 2,
           y = 0,
           vjust = -1) +
    geom_line(linewidth = 1) +
    labs(x = "", y = "Totaal aantal soorten", colour = "Regio") +
    theme(legend.position = "bottom")
```

Een overzicht van het aantal soorten per telpunt in de Westelijke leemstreek en de Zandleemstreek.

```{r}
mas_2023_vogels %>%
  st_drop_geometry() %>%
  group_by(regio, jaar, plotnaam, openheid_klasse, sbp, periode_in_jaar,
           naam) %>%
  summarise(totaal_aantal = sum(aantal),
            .groups = "drop_last") %>%
  summarise(aantal_soorten = n(),
            .groups = "drop") %>%
  mutate(stratum = paste(openheid_klasse, sbp, sep = " -\n")) %>%
  ggplot() +
    geom_hline(yintercept = 0, alpha = 0.2, linetype = "dashed") +
    geom_boxplot(aes(x = stratum, y = aantal_soorten,
                     colour = periode_in_jaar)) +
    facet_wrap(~regio) +
    labs(y = "Aantal soorten per telpunt", x = "", colour = "Telperiode")
```

Om welke soorten gaat het?

```{r}
roofvogels_f <- function() {
  roofvogels <- c("Blauwe Kiekendief", "Boomvalk", "Bruine Kiekendief",
                  "Buizerd", "Grauwe Kiekendief", "Ransuil", "Rode Wouw",
                  "Slechtvalk", "Smelleken", "Sperwer", "Steenuil",
                  "Steppekiekendief", "Torenvalk", "Velduil", "Wespendief",
                  "Zwarte Wouw")

  return(roofvogels)
}

doelsoorten <- c(
  "Veldleeuwerik", 
  "Gele Kwikstaart", 
  "Geelgors", 
  "Kievit", 
  "Grasmus",
  "Witte Kwikstaart",
  "Ringmus",
  "Kwartel",
  "Kneu",
  "Torenvalk")
```

```{r}
bezoekenlijst_2023 <- mas_2023_vogels %>%
  st_drop_geometry() %>%
  distinct(regio, jaar, plotnaam, periode_in_jaar)

relfreqs_vogels <- mas_2023_vogels %>%
  st_drop_geometry() %>%
  filter(ifelse(naam %in% roofvogels_f(), wrntype >= 0L, wrntype > 0L)) %>%
  group_by(regio, plotnaam, jaar, periode_in_jaar, naam) %>%
  summarise(totaal_aantal = sum(aantal),
            .groups = "drop") %>%
  pivot_wider(names_from = naam,
              values_from = totaal_aantal,
              values_fill = list(totaal_aantal = 0)) %>%
  full_join(bezoekenlijst_2023,
            by = join_by(regio, jaar, plotnaam, periode_in_jaar)) %>%
  replace(is.na(.), 0) %>%
  mutate(jaar = factor(jaar)) %>%
  group_by(jaar, periode_in_jaar, regio) %>%
  summarise(across(.cols = where(~ is.numeric(.x) && min(.x) == 0),
                   .fns = ~sum(.x > 0) / n()),
            n = n(),
            .groups = "drop") %>%
  pivot_longer(cols = where(is.double),
               names_to = "naam",
               values_to = "relfreq")
```

Overzicht van relatieve frequenties van de 20 meest frequente soorten in een bepaalde regio. Elk punt staat voor een relatieve frequentie in een bepaald jaar en een bepaalde telperiode van dat jaar. Enkel data met broedcode > 0 zijn weerhouden tenzij voor roofvogels.

```{r}
library(ggtext)
highlight <- function(x, pat, color="black", family="") {
  ifelse(x %in% pat,
         glue::glue("<b style='font-family:{family}; color:{color}'>{x}</b>"),
         x)
}
```

```{r}
freq_to_plot <- relfreqs_vogels %>%
  group_by(regio, naam) %>%
  mutate(
    w = n / sum(n),
    gemiddelde_freq = weighted.mean(relfreq, w)) %>%
  ungroup() %>%
  mutate(naam = reorder(naam, gemiddelde_freq, decreasing = FALSE)) %>%
  filter(as.numeric(naam) > length(unique(naam)) - 20 |
           naam %in% doelsoorten)
freq_to_plot %>%
  ggplot() +
    geom_vline(xintercept = 0, alpha = 0.2, linetype = "dashed") +
    geom_hline(yintercept = length(unique(freq_to_plot$naam)) - 20 + 0.5,
               alpha = 0.2, linetype = "dashed") +
    geom_point(aes(x = relfreq, y = naam, colour = regio),
               size = 1) +
    labs(y = "", x = "Relatieve frequentie", colour = "Regio") +
    scale_y_discrete(labels = function(x) highlight(x, doelsoorten, "red")) +
    theme(legend.position = "top",
          axis.text = element_text(size = 8),
          axis.text.y = element_markdown(),
          panel.spacing = unit(0.7, "lines")) +
    guides(colour = guide_legend(override.aes = list(size = 2)))
```

Top 20 van soorten die in termen van verschil in gemiddelde relatieve frequentie van voorkomen meer voorkomen in de Zandleemstreek dan in de Westelijke leemstreek:

```{r}
relfreqs_vogels %>%
  group_by(regio, naam) %>%
  mutate(
    w = n / sum(n),
    gemiddelde_freq = weighted.mean(relfreq, w)) %>%
  distinct(regio, naam, gemiddelde_freq) %>%
  pivot_wider(names_from = regio,
              values_from = gemiddelde_freq,
              values_fill = 0) %>%
  mutate(verschilfreq = `Zandleemstreek` - `Westelijke leemstreek`) %>%
  ungroup() %>%
  slice_max(verschilfreq, n = 20) %>%
  kable(digits = 2)
```

```{r}
relfreq_diff_zn <- relfreqs_vogels %>%
  select(-n) %>%
  pivot_wider(names_from = regio,
              values_from = relfreq,
              values_fill = 0) %>%
  mutate(verschilfreq = `Zandleemstreek` - `Westelijke leemstreek`) %>%
  mutate(naam = reorder(naam, verschilfreq, FUN = "mean",
                        decreasing = FALSE)) %>%
  filter(as.numeric(naam) > length(unique(naam)) - 20 |
           naam %in% doelsoorten)

relfreq_diff_zn %>%
  ggplot() +
    geom_vline(xintercept = 0,
               colour = "lightgrey") +
    geom_hline(yintercept = length(unique(relfreq_diff_zn$naam)) - 20 + 0.5,
               alpha = 0.2, linetype = "dashed") +
    geom_point(aes(x = verschilfreq, y = naam),
               size = 1) +
    labs(y = "", x = "Verschil in relatieve frequentie",
         title = "Algemener in de Zandleemstreek") +
    scale_y_discrete(labels = function(x) highlight(x, doelsoorten, "red")) +
    coord_cartesian(xlim = c(0 - abs(max(relfreq_diff_zn$verschilfreq)),
                             0 + abs(max(relfreq_diff_zn$verschilfreq)))) +
    scale_x_continuous(breaks = seq(-1, 1, 0.05)) +
    theme(legend.position = "top",
          axis.text = element_text(size = 8),
          axis.text.y = element_markdown(),
          panel.spacing = unit(1.2, "lines")) +
    guides(colour = guide_legend(override.aes = list(size = 3)))
```

Top 20 van soorten die in termen van verschil in gemiddelde relatieve frequentie van voorkomen meer voorkomen in de Westelijke leemstreek dan in de Zandleemstreek:

```{r}
relfreqs_vogels %>%
  group_by(regio, naam) %>%
  mutate(
    w = n / sum(n),
    gemiddelde_freq = weighted.mean(relfreq, w)) %>%
  distinct(regio, naam, gemiddelde_freq) %>%
  pivot_wider(names_from = regio,
              values_from = gemiddelde_freq,
              values_fill = 0) %>%
  mutate(verschilfreq = `Westelijke leemstreek` - `Zandleemstreek`) %>%
  ungroup() %>%
  slice_max(verschilfreq, n = 20) %>%
  kable(digits = 2)
```

```{r}
relfreq_diff_wl <- relfreqs_vogels %>%
  select(-n) %>%
  pivot_wider(names_from = regio,
              values_from = relfreq,
              values_fill = 0) %>%
  mutate(verschilfreq = `Westelijke leemstreek` - `Zandleemstreek`) %>%
  mutate(naam = reorder(naam, verschilfreq, FUN = "mean",
                        decreasing = FALSE)) %>%
  filter(as.numeric(naam) > length(unique(naam)) - 20 |
           naam %in% doelsoorten)

relfreq_diff_wl %>%
  ggplot() +
    geom_vline(xintercept = 0,
               colour = "lightgrey") +
    geom_hline(yintercept = length(unique(relfreq_diff_wl$naam)) - 20 + 0.5,
               alpha = 0.2, linetype = "dashed") +
    geom_point(aes(x = verschilfreq, y = naam),
               size = 1) +
    labs(y = "", x = "Verschil in relatieve frequentie",
         title = "Algemener in de Westelijke leemstreek") +
    scale_y_discrete(labels = function(x) highlight(x, doelsoorten, "red")) +
    coord_cartesian(xlim = c(0 - abs(max(relfreq_diff_wl$verschilfreq)),
                             0 + abs(max(relfreq_diff_wl$verschilfreq)))) +
    scale_x_continuous(breaks = seq(-1, 1, 0.05)) +
    theme(legend.position = "top",
          axis.text = element_text(size = 8),
          axis.text.y = element_markdown(),
          panel.spacing = unit(1.2, "lines")) +
    guides(colour = guide_legend(override.aes = list(size = 3)))
```

Top twintig van beide kanten in 1 figuur.

```{r}
relfreq_diff_total <- relfreqs_vogels %>%
  select(-n) %>%
  pivot_wider(names_from = regio,
              values_from = relfreq,
              values_fill = 0) %>%
  mutate(verschilfreq = `Zandleemstreek` - `Westelijke leemstreek`) %>%
  mutate(naam = reorder(naam, verschilfreq, FUN = "mean",
                        decreasing = FALSE)) %>%
  filter(as.numeric(naam) > length(unique(naam)) - 20 |
           as.numeric(naam) <= 20 |
           naam %in% doelsoorten)

relfreq_diff_total %>%
  ggplot() +
    geom_vline(xintercept = 0,
               colour = "lightgrey") +
    geom_hline(yintercept = c(20.5,
                length(unique(relfreq_diff_total$naam)) - 20 + 0.5),
               alpha = 0.2, linetype = "dashed") +
    geom_point(aes(x = verschilfreq, y = naam),
               size = 1) +
    labs(y = "", x = "Verschil in relatieve frequentie") +
    scale_y_discrete(labels = function(x) highlight(x, doelsoorten, "red")) +
    coord_cartesian(xlim = c(0 - abs(max(relfreq_diff_zn$verschilfreq)),
                             0 + abs(max(relfreq_diff_zn$verschilfreq)))) +
    scale_x_continuous(breaks = seq(-1, 1, 0.05)) +
    theme(legend.position = "top",
          axis.text = element_text(size = 8),
          axis.text.y = element_markdown(),
          panel.spacing = unit(1.2, "lines")) +
    guides(colour = guide_legend(override.aes = list(size = 3))) +
    annotate("segment",
             x = c(abs(max(relfreq_diff_zn$verschilfreq))),
             y = c(length(unique(relfreq_diff_total$naam)) - 20 + 1),
             xend = c(abs(max(relfreq_diff_zn$verschilfreq))),
             yend = c(length(unique(relfreq_diff_total$naam)) - 20 + 3),
             arrow = arrow(type = "closed", length = unit(0.015, "npc")),
             colour = "black") +
    annotate("segment",
           x = c(abs(max(relfreq_diff_zn$verschilfreq))),
           y = c(20.5 - 0.5),
           xend = c(abs(max(relfreq_diff_zn$verschilfreq))),
           yend = c(20.5 - 2.5),
           arrow = arrow(type = "closed", length = unit(0.015, "npc")),
           colour = "black") +
    annotate("text", label = c("Zandleemstrek"),
             x = c(abs(max(relfreq_diff_zn$verschilfreq)) + 0.01),
             y = c(length(unique(relfreq_diff_total$naam)) - 20 + 1),
             size = 2, hjust = "left", colour = "black", angle = 90) +
    annotate("text", label = c("Westelijke leemstreek"),
           x = c(abs(max(relfreq_diff_zn$verschilfreq)) + 0.01),
           y = c(20.5 - 0.5),
           size = 2, hjust = "right", colour = "black", angle = 90)
```
